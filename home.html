<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Charlotte & Gianluca â€” Home</title>

<!-- FONT -->
<link href="https://fonts.googleapis.com/css2?family=Cormorant:wght@300;400;500;600&family=Allura&display=swap" rel="stylesheet">

<!-- === GLOBAL LOGIN STYLE & MODAL (popup) === -->
<style>
/* Overlay scuro dietro al popup */
#guestLoginOverlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  display: none; /* nascosto di default */
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
  font-family: "Cormorant", serif;
}

/* Box popup */
#guestLoginModal {
  background: #fff;
  max-width: 360px;
  width: 100%;
  border-radius: 16px;
  box-shadow: 0 20px 60px rgba(0,0,0,.25);
  padding: 24px 20px 20px;
  position: relative;
  text-align: center;
  border: 1px solid rgba(0,0,0,.06);
}

/* Titolo popup */
#guestLoginModal h2 {
  font-family: "Allura", cursive;
  font-size: 32px;
  line-height: 1.2;
  color: var(--accent);
  margin: 0 0 10px;
}

/* Testo descrizione */
#guestLoginModal p {
  font-size: 18px;
  line-height: 1.4;
  margin: 0 0 16px;
  color: var(--ink);
  font-style: italic;
}

/* Form campi */
.guest-field {
  text-align: left;
  margin-bottom: 14px;
}
.guest-field label {
  display: block;
  font-size: 16px;
  margin-bottom: 4px;
  color: var(--muted);
}
.guest-field input {
  width: 100%;
  font-size: 18px;
  font-family: "Cormorant", serif;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  outline: none;
}
.guest-field input:focus {
  border-color: var(--accent);
}

/* Pulsanti nel popup */
#guestLoginActions {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 18px;
}

/* Bottone Conferma */
#guestConfirmBtn {
  background: var(--accent);
  color: #fff;
  border: none;
  border-radius: 12px;
  font-size: 18px;
  font-weight: 600;
  padding: 12px;
  cursor: pointer;
  font-family: "Cormorant", serif;
}
#guestConfirmBtn:hover {
  opacity: .95;
}

/* Link Esci / Logout */
#guestLogoutBtn {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 16px;
  text-decoration: underline;
  cursor: pointer;
  font-family: "Cormorant", serif;
}

/* Messaggio di errore nome non trovato */
#guestError {
  color: #b00020;
  font-size: 16px;
  text-align: center;
  display: none;
  margin-top: 8px;
  line-height: 1.4;
  font-family: "Cormorant", serif;
}
</style>

  
<style>
:root{
  --accent:#7465ad;
  --beige:#f7f4ef;
  --ink:#242424;
  --muted:#6b6b6b;
}
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family:"Cormorant",serif;
  color:var(--ink);
  background:var(--beige);
  background-image:
    radial-gradient(1200px 700px at 100% -10%, rgba(116,101,173,.10), transparent 60%),
    radial-gradient(900px 500px at -10% 10%, rgba(116,101,173,.06), transparent 55%);
  background-attachment:fixed;
}

/* HEADER BASE (stesso stile tutte le pagine) */
header {
  position:sticky;
  top:0;
  z-index:10;
  background:rgba(247,244,239,.88);
  backdrop-filter:blur(6px);
  border-bottom:1px solid rgba(0,0,0,.06);
  font-family:"Cormorant", serif;
}

.nav {
  max-width:1100px;
  margin:0 auto;
  padding:18px 22px;
  display:flex;
  align-items:center; /* centra verticalmente nomi/data/menu */
  justify-content:space-between;
  gap:12px;
}

/* brand = blocco sinistra header */
.brand {
  display:flex;
  align-items:center;
  flex-wrap:nowrap;
  gap:8px;
}

.names {
  font-family:"Allura", cursive;
  font-size:36px;
  line-height:1.1;
  color:var(--accent);
  white-space:nowrap;
}

.dot {
  color:var(--muted);
  font-size:20px;
  line-height:1.1;
}

.date {
  color:var(--muted);
  font-size:20px;
  line-height:1.1;
  letter-spacing:.4px;
  font-weight:500;
  white-space:nowrap;
}

/* MENU DESKTOP */
nav ul{ list-style:none; display:flex; gap:24px; margin:0; padding:0; }
nav a{ text-decoration:none; color:var(--ink); opacity:.95; font-size:19px; padding:8px 6px; border-radius:10px; }
nav a:hover{ opacity:1; border-bottom:1px solid var(--accent); }
nav li.cta a{ background:var(--accent); color:#fff; padding:10px 14px; border-radius:14px; border-bottom:none; font-weight:500; }
nav li.cta a:hover{ opacity:.95; transform:translateY(-1px); }

/* HAMBURGER (mobile) */
.hamburger {
  display:none;
  border:1px solid rgba(0,0,0,.1);
  background:#fff;
  border-radius:10px;
  padding:8px 10px;
  cursor:pointer;
}
.hamburger span {
  display:block;
  width:20px;
  height:2px;
  background:#444;
  margin:4px 0;
}

/* MENU MOBILE POPUP */
.mobile-menu {
  display:none;
  position:fixed;
  top:64px;
  left:16px; /* <-- PRIMA era right:16px */
  right:auto; /* <-- per sicurezza azzeriamo l'altro lato */
  background:#fff;
  border:1px solid rgba(0,0,0,.06);
  border-radius:16px;
  box-shadow:0 8px 40px rgba(0,0,0,.12);
  padding:12px;
  z-index:40;
}

.mobile-menu a {
  display:block;
  padding:10px 12px;
  border-radius:10px;
  color:var(--ink);
  text-decoration:none;
  font-family:"Cormorant", serif;
  font-size:18px;
}
.mobile-menu a:hover {
  background:rgba(116,101,173,.08);
}

/* HERO (blocco principale con lavanda, data, countdown) */
.hero {
  text-align:center;
  padding:60px 20px 30px;
}

.hero-img-wrapper {
  max-width:600px;     /* puoi aumentare tipo 600px */
  margin:0 auto 20px;  /* centra l'immagine e aggiunge spazio sotto */
}

.hero-img {
  display:block;
  width:100%;
  height:auto;
}

.date-line {
  font-family:"Cormorant", serif;
  font-size:20px;
  color:var(--muted);
  margin:24px 0 18px; /* â†‘ spazio sopra aumentato */
  font-style:italic;
}

/* Countdown wrapper */
.countdown {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 14px;
  flex-wrap: wrap;
  margin: 20px auto 0;     /* centra */
  max-width: 520px;        /* <-- LIMITE larghezza su desktop */
  width: 100%;
}

/* Ogni box del countdown */
.cd-box {
  flex: 1 1 auto;
  min-width: 110px;
  background:#fff;
  border:1px solid #eee;
  border-radius:14px;
  padding:12px 14px;
  text-align:center;
  box-shadow:0 10px 28px rgba(0,0,0,.06);
}

/* Numeri grandi */
.cd-num {
  font-size:30px;
  font-weight:600;
  color:var(--accent);
  line-height:1;
}

/* Etichetta Days / Hours / Minutes / Seconds */
.cd-label {
  font-size:12px;
  color:var(--muted);
  letter-spacing:.4px;
  text-transform:uppercase;
  margin-top:4px;
}

/* Mobile: su telefoni piccoli vogliamo che possano andare su due colonne */
@media (max-width:500px) {
  .countdown {
    max-width: 100%;
    justify-content: center;
  }
  .cd-box {
    min-width: 44%;
    flex: 1 1 44%;
  }
}


/* bottone RSVP sotto il countdown */
.btn{
  display:inline-block;
  background:var(--accent);
  color:#fff;
  text-decoration:none;
  padding:12px 22px;
  border-radius:16px;
  font-weight:600;
  font-family:"Cormorant", serif;
}
.btn:hover{opacity:.95}

/* Sezione lingue con blocchi */
.section{
  max-width:900px;
  margin:0 auto;
  padding:40px 20px 80px;
  text-align:center;
}

.lang-block{
  background:#fff;
  border-radius:18px;
  border:1px solid #eee;
  padding:24px;
  margin-top:24px;
}

/* Titolo tipo Benvenuti / Welcome / Bienvenue */
.lang-block h2{
  margin:0 0 10px;
  font-family:"Allura", cursive;
  font-size:42px;
  font-weight:400;
  color:var(--accent);
  line-height:1.2;
}

.lang-block p{
  margin:0 0 14px;
  font-family:"Cormorant", serif;
  font-size:18px;
  color:var(--ink);
  line-height:1.4;
}

/* Footer */
footer{
  text-align:center;
  color:#6b6b6b;
  padding:40px 20px;
  font-size:14px;
}

/* RESPONSIVE */
@media(max-width:600px){
  .nav {
    width:100%;
    padding:16px 12px;
  }
  .hamburger { display:block; }
  nav ul { display:none; }
  .names { font-size:30px; }
  .date  { font-size:17px; }

  .mobile-menu {
    top:58px;
    left:12px;   /* spostato a sinistra */
    right:auto;  /* niente piÃ¹ right */
  }
}

  .cd-box{ min-width:44%; }
  nav a{ font-size:18px; padding:10px 8px; }
}
</style>
</head>
<body>

  <!-- === LOGIN MODAL OVERLAY (popup iniziale e per logout) === -->
<div id="guestLoginOverlay" role="dialog" aria-modal="true">
  <div id="guestLoginModal">

    <!-- Titolo -->
    <h2>Welcome</h2>

    <!-- Testo: chiediamo nome e cognome, senza spiegare il motivo -->
    <p>
      Please enter your first and last name.<br>
      Veuillez saisir votre prÃ©nom et nom.<br>
      Inserisci nome e cognome.
    </p>

    <!-- CAMPO NOME -->
    <div class="guest-field">
      <label for="guestFirst">Name Â· PrÃ©nom Â· Nome</label>
      <input type="text" id="guestFirst" placeholder="Charlotte / Gianluca / ..." />
    </div>

    <!-- CAMPO COGNOME -->
    <div class="guest-field">
      <label for="guestLast">Surname Â· Nom Â· Cognome</label>
      <input type="text" id="guestLast" placeholder="Francis / GuardalÃ  / ..." />
    </div>

    <!-- ERROR MSG -->
    <div id="guestError">
      Name not recognized.<br>
      Nom non reconnu.<br>
      Nome non trovato.
    </div>

    <!-- AZIONI -->
    <div id="guestLoginActions">
      <button id="guestConfirmBtn">OK</button>
      <button id="guestLogoutBtn" style="display:none;">Log out / DÃ©connexion / Esci</button>
    </div>

  </div>
</div>


<header>
  <div class="nav">
    <div class="brand">
      <button id="hambBtn" class="hamburger" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
      <div class="names">Charlotte &amp; Gianluca</div>
      <div class="dot">Â·</div>
      <div class="date">20.06.26</div>
    </div>

    <nav>
      <ul>
        <li><a href="/home.html">Home</a></li>
        <li><a href="/story.html">Our story</a></li>
        <li><a href="/stay.html">Plan your trip</a></li>
        <li><a href="/trip.html">Honeymoon</a></li>
        <li><a href="/this-or-that.html">Vibe test</a></li>
        <li class="cta"><a href="/rsvp.html">RSVP</a></li>
      </ul>
    </nav>
  </div>

  <div id="mobileMenu" class="mobile-menu">
    <a href="/home.html">Home</a>
    <a href="/story.html">Our story</a>
    <a href="/stay.html">Plan your trip</a>
    <a href="/trip.html">Honeymoon</a>
    <a href="/this-or-that.html">Vibe test</a>
    <a href="/rsvp.html"><strong>RSVP</strong></a>
  </div>
</header>

<main>
  <section class="hero">
    <!-- immagine lavanda + nomi -->
    <div class="hero-img-wrapper">
      <img
        src="/assets/hero-lavanda.jpg"
        alt="Charlotte & Gianluca"
        class="hero-img"
        loading="lazy"
        decoding="async"
      />
    </div>


    <!-- Countdown -->
    <div id="countdown" class="countdown" aria-label="Countdown to the wedding">
      <div class="cd-box">
        <div class="cd-num" id="cd-days">â€”</div>
        <div class="cd-label">Days</div>
      </div>
      <div class="cd-box">
        <div class="cd-num" id="cd-hours">â€”</div>
        <div class="cd-label">Hours</div>
      </div>
      <div class="cd-box">
        <div class="cd-num" id="cd-mins">â€”</div>
        <div class="cd-label">Minutes</div>
      </div>
      <div class="cd-box">
        <div class="cd-num" id="cd-secs">â€”</div>
        <div class="cd-label">Seconds</div>
      </div>
    </div>

   <p class="date-line">20.06.26 â€” ChÃ¢teau de Pradines, Grambois</p>

  </section>

  <section class="section">
<div class="lang-block">
  <h2>ðŸ‡®ðŸ‡¹ Benvenuti</h2>
  <p>Siamo felicissimi di invitarvi al nostro matrimonio!</p>
  <p>Vi aspettiamo per un weekend di festeggiamento tra i campi di lavanda e i borghi pittoreschi della Provenza.</p>
  <p><a class="btn" href="/rsvp.html">Conferma la tua presenza!</a></p>
</div>

<div class="lang-block">
  <h2>ðŸ‡«ðŸ‡· Bienvenue</h2>
  <p>Nous sommes trÃ¨s heureux de vous inviter Ã  notre mariage!</p>
  <p>Nous vous attendons pour un week-end de fÃªte parmi les champs de lavande et les villages pittoresques de Provence.</p>
  <p><a class="btn" href="/rsvp.html">Confirme ta prÃ©sence !</a></p>
</div>

<div class="lang-block">
  <h2>ðŸ‡¬ðŸ‡§ Welcome</h2>
  <p>We are thrilled to invite you to our wedding!</p>
  <p>We look forward to a weekend of celebration surrounded by lavender fields and the beautiful villages of Provence.</p>
  <p><a class="btn" href="/rsvp.html">Confirm your presence!</a></p>
</div>

  </section>
</main>

<footer>
  <small>Â© Charlotte &amp; Gianluca â€” 2026</small>
</footer>

<script>
// ========================
// 1) MENU MOBILE
// ========================
(function(){
  const btn  = document.getElementById('hambBtn');
  const menu = document.getElementById('mobileMenu');
  if(btn && menu){
    btn.addEventListener('click', e=>{
      e.stopPropagation();
      menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
    });
    document.addEventListener('click', e=>{
      if(menu.style.display === 'block' && !menu.contains(e.target) && e.target !== btn){
        menu.style.display = 'none';
      }
    });
  }
})();


// ========================
// 2) LISTA VIP (stringhe "Nome Cognome")
// ========================
const VIP_LIST = [
  "Charlotte Francis",
  "Yves Francis",
  "Laurence Hoppe",
  "ChloÃ© Francis",
  "Maya Mertens",
  "Chiara Regalia",
  "Matteo Biroli",
  "Chiara Sestini",
  "Riccardo Magri",
  "Marta Vitro",
  "Mattia Marco",
  "Andrea Rodriguez",
  "Piero Giuriolo",
  "Pietro Favari",
  "Elisa Ferrantelli",
  "Francesco Santermosi",
  "Viviana Serdoz",
  "Francesca Garoia",
  "Malve Malvestio",
  "Attilia La Vecchia",
  "Stefano de Looper",
  "Clara Simon",
  "Marine Lesage",
  "Thomas Hulet",
  "Nicola delle Foglie",
  "Baptiste Charvat",
  "Liza Bibakova",
  "IphigÃ©nie Loukakis",
  "Sara Nyssen",
  "Koen Slingerland",
  "Gianluca GuardalÃ ",
  "Francesca Arduini",
  "Benedict Fritz",
  "Isidoro GuardalÃ ",
  "Simona GuardalÃ ",
  "Alessando GuardalÃ ",
  "Irene GuardalÃ ",
  "Patrick",
  "Emanuela Zannetti",
  "Andrea Perozziello",
  "Chiara",
  "Fabio Tarricone",
  "Gisella Martino Capeda",
  "Gisella Martino",
  "Edoardo Cutolo",
  "Giorgia Piras",
  "Edoardo Papini",
  "Vittorio Corti",
  "Benedetta Barbaresi",
  "Giacomo Gussoni",
  "Matteo Rossi",
  "Lucrezia Piracci",
  "Davide Bellotto",
  "Silvia Oltrabella",
  "Ludovico SIbani",
  "Silvia Pignotti",
  "Benedetta Testoni",
  "Giovanni De Maria",
  "Edoardo Ferrario",
  "Alessandro Bianchi",
  "Beatrice Villa",
  "Luca Caravaggi",
  "Mara Moschino",
  "Marzia Campanile",
  "Nikola Calic",
  "Filippo Suglia",
  "Camilla Russo",
  "Laerte Adami",
  "Noemi",
  "Alberto Garlaschelli",
  "Jacopo Guarneri",
  "Lorenzo Cederna",
  "Benedetta Pintus"
];


// ========================
// 3) UTILS (normalize + parsing + match cognomi doppi)
// ========================
function normalize(str){
  return (str || "")
    .trim()
    .toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g, "")    // togli accenti
    .replace(/[^\p{L}\p{N}\s'-]/gu, "")                 // leva simboli strani
    .replace(/\s+/g, " ");                               // compatta spazi
}

function splitName(full){
  const parts = normalize(full).split(" ").filter(Boolean);
  if(parts.length === 0) return { first:"", last:"" };
  const first = parts[0];
  const last  = parts.slice(1).join(" "); // puÃ² essere vuoto o multiplo (doppi cognomi)
  return { first, last };
}

const VIP_PARSED = VIP_LIST.map(splitName);

function surnameTokens(str){
  return normalize(str).split(/[\s-]+/).filter(Boolean);
}

// Regola: cognome VIP vuoto â†’ basta il nome.
// Altrimenti: match totale OPPURE almeno 1 token in comune (gestisce doppi cognomi stile spagnolo).
function surnameMatches(userLast, vipLast){
  const v = surnameTokens(vipLast);
  if(v.length === 0) return true;
  const u = surnameTokens(userLast);
  if(u.length === 0) return false;

  if(u.join(" ") === v.join(" ")) return true;          // match completo
  return u.some(tok => v.includes(tok));                // almeno un token combacia
}

function isVipName(userFirst, userLast){
  const nf = normalize(userFirst);
  const nl = normalize(userLast);
  return VIP_PARSED.some(v => v.first === nf && surnameMatches(nl, v.last));
}


// ========================
// 4) VIP STATE & VISIBILITÃ€
// ========================
function isVIP(){
  return localStorage.getItem("isVIP") === "true";
}
function hasIdentification(){
  return !!localStorage.getItem("guestName");
}
function applyVIPVisibility(){
  const vipBlocks    = document.querySelectorAll(".vip-only");
  const nonVipBlocks = document.querySelectorAll(".non-vip-only");
  if(isVIP()){
    vipBlocks.forEach(el => el.style.display = "");
    nonVipBlocks.forEach(el => el.style.display = "none");
  } else {
    vipBlocks.forEach(el => el.style.display = "none");
    nonVipBlocks.forEach(el => el.style.display = "");
  }
}


// ========================
// 5) MODAL CONTROL
// ========================
function openLoginModal(){
  const overlay = document.getElementById("guestLoginOverlay");
  if(overlay) overlay.style.display = "flex";
}
function closeLoginModal(){
  const overlay = document.getElementById("guestLoginOverlay");
  if(overlay) overlay.style.display = "none";
}
function doLogout(){
  localStorage.removeItem("guestName");
  localStorage.removeItem("isVIP");
  openLoginModal();
  applyVIPVisibility();
  const logoutBtn = document.getElementById("guestLogoutBtn");
  if(logoutBtn) logoutBtn.style.display = "none";
}


// ========================
// 6) SUBMIT LOGIN
// ========================
function submitGuestData(){
  const firstEl = document.getElementById("guestFirst");
  const lastEl  = document.getElementById("guestLast");
  const errEl   = document.getElementById("guestError");
  if(!firstEl || !lastEl) return;

  const first = (firstEl.value || "");
  const last  = (lastEl.value  || "");

  if(!first.trim() || !last.trim()){
    if(errEl){
      errEl.innerHTML = "Please enter both fields.<br>Veuillez remplir les deux champs.<br>Inserisci nome e cognome.";
      errEl.style.display = "block";
    }
    return;
  }

  const guestIsVIP = isVipName(first, last);

  localStorage.setItem("guestName", (first + " " + last).trim());
  localStorage.setItem("isVIP", guestIsVIP ? "true" : "false");

  closeLoginModal();
  applyVIPVisibility();
}


// ========================
// 7) INIT
// ========================
document.addEventListener("DOMContentLoaded", () => {
  const confirmBtn = document.getElementById("guestConfirmBtn");
  const logoutBtn  = document.getElementById("guestLogoutBtn");
  const overlay    = document.getElementById("guestLoginOverlay");
  const errEl      = document.getElementById("guestError");

  if(hasIdentification()){
    if(overlay) overlay.style.display = "none";
    if(logoutBtn){
      logoutBtn.style.display = "inline-block";
      logoutBtn.addEventListener("click", doLogout);
    }
  } else {
    if(overlay) overlay.style.display = "flex";
    if(errEl)   errEl.style.display = "none";
    if(logoutBtn){
      logoutBtn.style.display = "none";
      logoutBtn.addEventListener("click", doLogout);
    }
  }

  if(confirmBtn){
    confirmBtn.addEventListener("click", (e)=>{
      e.preventDefault();
      submitGuestData();
    });
  }

  applyVIPVisibility();
});
</script>



  <script>
// COUNTDOWN to 2026-06-20 16:30 local time
(function(){
  const dEl = document.getElementById('cd-days');
  const hEl = document.getElementById('cd-hours');
  const mEl = document.getElementById('cd-mins');
  const sEl = document.getElementById('cd-secs');

  if (!dEl || !hEl || !mEl || !sEl) return; // sicurezza se usi stesso script in altre pagine

  // Data target (matrimonio) â€” uso orario 16:30 con timezone italiana (CEST in estate)
  const target = new Date('2026-06-20T16:30:00+02:00').getTime();

  function tick(){
    const now = Date.now();
    let diff = Math.max(0, target - now);

    const days = Math.floor(diff / 86400000); // ms in un giorno
    diff -= days * 86400000;

    const hours = Math.floor(diff / 3600000);
    diff -= hours * 3600000;

    const mins = Math.floor(diff / 60000);
    diff -= mins * 60000;

    const secs = Math.floor(diff / 1000);

    dEl.textContent = days;
    hEl.textContent = String(hours).padStart(2,'0');
    mEl.textContent = String(mins).padStart(2,'0');
    sEl.textContent = String(secs).padStart(2,'0');
  }

  tick();
  setInterval(tick, 1000);
})();
</script>

<!-- Falling White Petals (3â€“4s burst) -->
<style>
  @keyframes petal-fall {
    0%   { transform: translate3d(var(--x,0), -10vh, 0) rotate(var(--r0,0deg)); opacity: 0; }
    5%   { opacity: var(--op,0.9); }
    100% { transform: translate3d(var(--xend,0), 110vh, 0) rotate(var(--r1,360deg)); opacity: 0; }
  }
  .petal {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 9999;
    pointer-events: none;
    width: var(--sz,14px);
    height: calc(var(--sz,14px) * 1.2);
    /* forma "petalo" con bordi morbidi */
    border-radius: 70% 30% 70% 30% / 60% 40% 60% 40%;
    /* bianco con leggero rilievo */
    background: radial-gradient(ellipse at 30% 30%, rgba(255,255,255,1) 0%, rgba(255,255,255,0.92) 60%, rgba(255,255,255,0.8) 100%);
    box-shadow: 0 1px 2px rgba(0,0,0,0.08);
    will-change: transform, opacity;
    animation: petal-fall linear forwards;
  }
  /* riduci o disattiva per chi preferisce meno motion */
  @media (prefers-reduced-motion: reduce) {
    .petal { animation-duration: 6s !important; }
  }
</style>

<script>
  // Tiny "plugin": startPetals({spawnForMs, maxPerSecond})
  (function(){
    function rand(min, max){ return Math.random()*(max-min)+min; }

    function createPetal(viewW){
      const el = document.createElement('span');
      el.className = 'petal';

      // dimensioni e opacitÃ 
      const size = rand(10,18); // px
      el.style.setProperty('--sz', size + 'px');
      el.style.setProperty('--op', rand(0.7, 0.95));

      // punto di partenza e â€œswayâ€ orizzontale
      const startX = rand(0, viewW);
      const drift   = rand(-120, 120); // deviazione orizzontale
      el.style.setProperty('--x',  startX + 'px');
      el.style.setProperty('--xend', (startX + drift) + 'px');

      // rotazioni random
      el.style.setProperty('--r0', rand(-90, 90) + 'deg');
      el.style.setProperty('--r1', rand(180, 1080) + 'deg');

      // durata e delay per varietÃ 
      const dur = rand(7, 12); // s
      const delay = rand(-2, 0); // alcuni giÃ  "in aria"
      el.style.animationDuration = dur + 's';
      el.style.animationDelay = delay + 's';

      // rimozione a fine animazione
      el.addEventListener('animationend', () => el.remove());
      return el;
    }

    function startPetals(opts){
      const settings = Object.assign({
        spawnForMs: 3500,     // quanto tempo generare nuovi petali
        maxPerSecond: 22,     // intensitÃ  (desktop). Su mobile scaleremo
      }, opts || {});

      // Rispetta prefers-reduced-motion
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(reduce){ settings.maxPerSecond = Math.min(6, settings.maxPerSecond); settings.spawnForMs = Math.min(1500, settings.spawnForMs); }

      const isMobile = Math.max(window.innerWidth, window.innerHeight) < 820;
      const intensity = Math.round(settings.maxPerSecond * (isMobile ? 0.6 : 1));

      const start = performance.now();
      let rafId;

      (function loop(now){
        const elapsed = now - start;
        // genera un piccolo "burst" per frame (Poisson-like)
        const petalsThisFrame = Math.random() < 0.9 ? 1 : 2; // variazione
        if(elapsed <= settings.spawnForMs){
          for(let i=0;i<petalsThisFrame;i++){
            // probabilitÃ  in base all'intensitÃ  e al frame (~60fps)
            if(Math.random() < intensity/60){
              document.body.appendChild(createPetal(window.innerWidth));
            }
          }
          rafId = requestAnimationFrame(loop);
        } else {
          cancelAnimationFrame(rafId);
        }
      })(performance.now());
    }

    // Esporta globalmente per riuso (es. su click di un bottone)
    window.startPetals = startPetals;

    // Avvio automatico all'ingresso pagina (3.5s)
    document.addEventListener('DOMContentLoaded', function(){
      startPetals({ spawnForMs: 3500, maxPerSecond: 22 });
    });
  })();
</script>


  
</body>
</html>
