<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Team Cha ðŸ’œ vs Team Gianlu ðŸ§¢ â€“ This or That</title>
  <link href="https://fonts.googleapis.com/css2?family=Allura&family=Cormorant:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --lavender:#bca9e0;
      --lavender-600:#9d87d1;
      --beige:#f7f3eb;
      --ink:#2a2438;
      --muted:#7b6f8e;
      --white:#ffffff;
    }
    *{ box-sizing: border-box; }
    html, body{ height:100%; }
    body{
      margin:0; background:var(--beige);
      color:var(--ink);
      font-family:'Cormorant', serif;
      display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .card{
      width:min(880px, 100%);
      background:var(--white);
      border-radius:24px; box-shadow:0 10px 30px rgba(42,36,56,.12);
      overflow:hidden; border:1px solid rgba(157,135,209,.18);
      position:relative;
    }
    header{
      padding:28px 28px 16px;
      background:linear-gradient(135deg, var(--beige), #fff 40%, var(--beige));
    }
    .title{
      font-family:'Allura', cursive; font-size:48px; line-height:1; margin:0 0 8px;
      color:var(--lavender-600);
      text-align:center;
    }
    .subtitle{ text-align:center; margin:0; color:var(--muted); font-size:20px; }

    .progress-wrap{ padding:12px 28px 0; }
    .progress{
      width:100%; height:10px; background:#efeaf8; border-radius:999px; overflow:hidden; position:relative;
    }
    .progress > span{ display:block; height:100%; width:0%; background:var(--lavender-600); transition:width .35s ease; }
    .progress-text{ text-align:right; font-size:14px; color:var(--muted); margin-top:6px; }

    .content{ padding:24px 28px 32px; }

    .qmeta{ text-align:center; font-size:28px; color:var(--muted); margin-bottom:10px; }
    .question{ font-size:28px; margin:8px 0 18px; text-align:center; font-weight:600; }
    .options{ display:grid; grid-template-columns:1fr 1fr; gap:14px; max-width:720px; margin:14px auto 8px; }
    @media (max-width:719px){ .options{ grid-template-columns:1fr; } }

    .btn{
      appearance:none; border:none; cursor:pointer; border-radius:16px; padding:18px 16px; font-size:18px; line-height:1.2;
      background:#faf7ff; color:var(--ink); box-shadow:0 4px 14px rgba(157,135,209,.18);
      transition: transform .06s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
      border:1px solid rgba(157,135,209,.22);
    }
    .btn.half{ min-height:100px; }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 6px 18px rgba(157,135,209,.22); background:#f7f1ff; }
    .btn:active{ transform:translateY(0); }
    .btn.selected{ outline:3px solid var(--lavender-600); box-shadow:0 0 0 4px rgba(157,135,209,.15); background:#efeaf8; border-color: var(--lavender-600); }

    @keyframes shake { 10%, 90% {transform: translateX(-1px);} 20%,80% {transform: translateX(2px);} 30%,50%,70% {transform: translateX(-4px);} 40%,60% {transform: translateX(4px);} }
    .need-pick { animation: shake .4s; }

    .nav{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:18px; }
    .nav button{
      padding:12px 16px; border-radius:14px; border:1px solid rgba(157,135,209,.35);
      background:var(--white); font-size:16px; cursor:pointer; color:var(--ink);
    }
    .nav button.primary{ background:var(--lavender-600); color:#fff; border-color:transparent; }
    .nav button[disabled]{ opacity:.45; cursor:not-allowed; }

    .footer-note{ text-align:center; color:var(--muted); font-size:16px; margin-top:8px; }

    .result{ display:none; text-align:center; padding:8px 0; }
    .score-wrap{ display:flex; align-items:center; gap:8px; margin:18px auto; max-width:520px; }
    .bar{ height:16px; width:100%; background:#efeaf8; border-radius:999px; overflow:hidden; display:flex; }
    .bar .cha{ background:#f3d8ee; height:100%; width:50%; transition:width .6s ease; }
    .bar .gianlu{ background:#cfd4ff; height:100%; width:50%; transition:width .6s ease; }
    .legend{ display:flex; justify-content:space-between; font-size:18px; color:var(--muted); }
    .pill{ display:inline-block; padding:6px 10px; background:#efeaf8; border-radius:999px; font-size:16px; color:var(--muted); margin:4px; }
    .share{ margin-top:14px; }

    .hidden{ display:none !important; }

    .exit-wrap{
      display:flex; justify-content:center; padding:20px 0 32px;
    }
    .exit-btn{
      background:#fff; border:1px solid rgba(157,135,209,.35); border-radius:14px;
      padding:8px 16px; font-size:16px; color:var(--muted); cursor:pointer;
      transition:all .2s ease; box-shadow:0 2px 6px rgba(157,135,209,.1); margin-bottom:0;
    }
    .exit-btn:hover{ background:#f7f1ff; color:var(--ink); box-shadow:0 4px 12px rgba(157,135,209,.15); }

    /* Language overlay */
    .lang-overlay{
      position:fixed; inset:0; background:rgba(247,243,235,.92);
      display:flex; align-items:center; justify-content:center; padding:24px; z-index:50;
      backdrop-filter: blur(2px);
    }
    .lang-modal{
      width:min(560px, 100%); background:#fff; border:1px solid rgba(157,135,209,.35);
      border-radius:20px; padding:24px; box-shadow:0 12px 30px rgba(42,36,56,.12); text-align:center;
    }
    .lang-modal h2{
      margin:0 0 6px; font-family:'Allura', cursive; font-size:42px; color:var(--lavender-600);
    }
    .lang-modal p{ margin:0 0 18px; color:var(--muted); font-size:18px; }
    .lang-grid{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; }
    .lang-btn{
      border:1px solid rgba(157,135,209,.35); background:#faf7ff; border-radius:14px; padding:14px 16px;
      font-size:18px; cursor:pointer; transition:.2s; box-shadow:0 4px 10px rgba(157,135,209,.15);
    }
    .lang-btn:hover{ background:#f7f1ff; transform:translateY(-1px); }
  </style>
</head>
<body>
  <!-- Language chooser -->
  <div id="langOverlay" class="lang-overlay" role="dialog" aria-modal="true">
      <div class="lang-grid">
        <button class="lang-btn" data-lang="it" aria-label="Italiano">ðŸ‡®ðŸ‡¹ Italiano</button>
        <button class="lang-btn" data-lang="fr" aria-label="FranÃ§ais">ðŸ‡«ðŸ‡· FranÃ§ais</button>
        <button class="lang-btn" data-lang="en" aria-label="English">ðŸ‡¬ðŸ‡§ English</button>
      </div>
    </div>
  </div>

  <main class="card" role="main" aria-labelledby="game-title">
    <header>
      <h1 id="game-title" class="title">Vibe Cha ðŸ’œ vs Vibe Gianlu ðŸ§¢</h1>
      <p id="subtitle" class="subtitle">This or That â€” Pick your vibe. Discover your team at the end!</p>
    </header>

    <div class="progress-wrap">
      <div class="progress" aria-hidden="true"><span id="progressBar"></span></div>
      <div class="progress-text" id="progressText">Question 1 of 14</div>
    </div>

    <section class="content" id="quiz" aria-live="polite">
      <div class="qmeta" id="qMeta"></div>
      <div class="question" id="questionText"></div>
      <div class="options" id="options"></div>
      <div class="nav">
        <button id="prevBtn" aria-label="Previous question">âŸµ Back</button>
        <button id="nextBtn" class="primary" aria-label="Next question">Next âŸ¶</button>
      </div>
    </section>

    <section class="content result" id="result">
      <h2 id="resultTitle" class="question" style="margin-top:0">Your Result</h2>
      <div class="score-wrap">
        <div class="bar" aria-hidden="true">
          <div class="gianlu" id="gBar" title="Gianlu"></div>
          <div class="cha" id="cBar" title="Cha"></div>
        </div>
      </div>
      <div class="legend" id="legend"> 
        <span>ðŸ§¢ Gianlu: <strong id="gPct">50%</strong></span>
        <span>ðŸ’œ Cha: <strong id="cPct">50%</strong></span>
      </div>
      <p id="summaryText" style="font-size:22px; margin-top:10px"></p>
      <div id="traits" style="margin:8px 0 2px"></div>

      <div class="share">
        <button id="shareBtn" class="primary" style="margin-right:8px">Share result</button>
        <button id="restartBtn">Play again</button>
        <div id="shareFeedback" class="footer-note" aria-live="polite" style="margin-top:8px; min-height:1.2em"></div>
      </div>
    </section>

    <div class="exit-wrap">
      <button id="exitBtn" class="exit-btn" aria-label="Exit game">EXIT</button>
    </div>
  </main>

<script>
  // -------------------- i18n strings --------------------
  const STRINGS = {
    it: {
      subtitle: "Scegli il tuo vibe. Scopri il tuo team alla fine!",
      progress: (i,n) => `Domanda ${i} di ${n}`,
      back: "âŸµ Indietro",
      resultTitle: "Il tuo risultato",
      moreG: "Sei piÃ¹ Team Gianlu ðŸ§¢",
      moreC: "Sei piÃ¹ Team Cha ðŸ’œ",
      tie: "ParitÃ  perfetta!",
      share: "Condividi risultato",
      playAgain: "Rigioca",
      allDone: "Tutto fatto!",
      exit: "ESCI",
      shared: "Condiviso!",
      copied: "Copiato negli appunti!",
      shareFail: "Condivisione non riuscita. Copia manualmente.",
      shareText: (g,c,summary,url) => `Ho ottenuto ${g}% Gianlu ðŸ§¢ e ${c}% Cha ðŸ’œ in â€œTeam Cha vs Team Gianlu â€“ This or Thatâ€. ${summary} ${url}`
    },
    fr: {
      subtitle: "Choisis ton vibe. DÃ©couvre ton Ã©quipe Ã  la fin !",
      progress: (i,n) => `Question ${i} sur ${n}`,
      back: "âŸµ Retour",
      resultTitle: "Ton rÃ©sultat",
      moreG: "Tu es plutÃ´t Team Gianlu ðŸ§¢",
      moreC: "Tu es plutÃ´t Team Cha ðŸ’œ",
      tie: "Ã‰galitÃ© parfaite !",
      share: "Partager le rÃ©sultat",
      playAgain: "Rejouer",
      allDone: "C'est terminÃ© !",
      exit: "QUITTER",
      shared: "PartagÃ© !",
      copied: "CopiÃ© dans le presse-papiers !",
      shareFail: "Partage impossible. Copie manuelle.",
      shareText: (g,c,summary,url) => `Jâ€™ai eu ${g}% Gianlu ðŸ§¢ et ${c}% Cha ðŸ’œ sur â€œTeam Cha vs Team Gianlu â€“ This or Thatâ€. ${summary} ${url}`
    },
    en: {
      subtitle: "Pick your vibe. Discover your team at the end!",
      progress: (i,n) => `Question ${i} of ${n}`,
      back: "âŸµ Back",
      resultTitle: "Your Result",
      moreG: "Youâ€™re more Team Gianlu ðŸ§¢",
      moreC: "Youâ€™re more Team Cha ðŸ’œ",
      tie: "Itâ€™s a perfect tie!",
      share: "Share result",
      playAgain: "Play again",
      allDone: "All done!",
      exit: "EXIT",
      shared: "Shared!",
      copied: "Copied to clipboard!",
      shareFail: "Could not share. Try copying manually.",
      shareText: (g,c,summary,url) => `I got ${g}% Gianlu ðŸ§¢ and ${c}% Cha ðŸ’œ on â€œTeam Cha vs Team Gianlu â€“ This or Thatâ€. ${summary} ${url}`
    }
  };

  // -------------------- Questions by language --------------------
  const QUESTIONS_BY_LANG = {
    it: [
      { t: "Quando guardo un film", left: "Mi addormento dopo 10 minuti", right: "Lo guardo fino alla fine" },
      { t: "Il letto", left: "Va sempre rifatto", right: "Tanto stasera lo devo ridisfare!" },
      { t: "Il tubetto di dentifricio", left: "lo spremo dal fondo fino all'ultimo grammo", right: "lo spremo come capita" },
      { t: "Quanta acqua bevi?", left: "A volte bevo il primo bicchiere nel pomeriggio", right: "2L al giorno, no scuse" },
      { t: "Cucini?", left: "Sempre, e mi piace", right: "Qualcun altro lo fa per me" },
      { t: "Quando scrivo una email", left: "La scrivo di getto", right: "La rileggo 10 volte prima di inviare" },
      { t: "La valigia prima di un viaggio", left: "La faccio 30 minuti prima", right: "Inzio a prepararla una settimana prima" },
      { t: "Quando vado a cena con amici", left: "Sono il primo a finire", right: "Gli altri mi guardano finire il mio piatto" },
      { t: "La mia giornata di vacanza perfetta eÃ©", left: "Hikiking in montagna", right: "Giornata in spiaggia a prendere il sole con un libro" },
      { t: "Quando vado a fare shopping", left: "Guardo prima il prezzo", right: "Scopro il prezzo alla cassa" },
      { t: "Quando vado a eltto a dormire", left: "Mi addormento in 2 secondi", right: "Conto le pecore per unâ€™ora" },
      { t: "Una chiamata con i miei gentoru", left: "Dura in media 2 minuti (se rispondo)", right: "Dura un'ora, devo aggiornarli su tutto" },
      { t: "La mia gironata ideale sugli sci Ã¨:", left: "Giornaliero + panini nello zaino", right: "2 ore skipass + pranzo in baita" },
      { t: "Faresti mai bungee jumping?", left: "Subito!", right: "Neanche se mi paghi" }
    ],
fr: [
  { t: "Quand je regarde un film", left: "Je mâ€™endors aprÃ¨s 10 minutes", right: "Je le regarde jusquâ€™Ã  la fin" },
  { t: "Le lit", left: "Doit toujours Ãªtre fait", right: "Inutile, je vais le dÃ©faire ce soir !" },
  { t: "Le tube de dentifrice", left: "Je le presse du bas jusquâ€™Ã  la derniÃ¨re goutte", right: "Je le presse nâ€™importe oÃ¹" },
  { t: "Combien dâ€™eau bois-tu ?", left: "Parfois mon premier verre est lâ€™aprÃ¨s-midi", right: "2 L par jour, pas dâ€™excuses" },
  { t: "Tu cuisines ?", left: "Toujours, et jâ€™adore Ã§a", right: "Quelquâ€™un dâ€™autre le fait pour moi" },
  { t: "Quand jâ€™Ã©cris un e-mail", left: "Je lâ€™Ã©cris dâ€™un seul jet", right: "Je le relis dix fois avant dâ€™envoyer" },
  { t: "La valise avant un voyage", left: "Je la fais 30 minutes avant de partir", right: "Je commence Ã  la prÃ©parer une semaine avant" },
  { t: "Quand je sors dÃ®ner avec des amis", left: "Je finis toujours en premier", right: "Les autres mâ€™attendent pour finir mon assiette" },
  { t: "Ma journÃ©e de vacances parfaite", left: "RandonnÃ©e en montagne", right: "JournÃ©e Ã  la plage avec un livre au soleil" },
  { t: "Quand je fais du shopping", left: "Je regarde le prix dâ€™abord", right: "Je dÃ©couvre le prix Ã  la caisse" },
  { t: "Quand je vais me coucher", left: "Je mâ€™endors en 2 secondes", right: "Je compte les moutons pendant une heure" },
  { t: "Un appel avec mes parents", left: "Dure 2 minutes en moyenne (si je rÃ©ponds)", right: "Dure une heure, je dois tout leur raconter" },
  { t: "Ma journÃ©e de ski idÃ©ale", left: "Forfait journÃ©e + sandwichs dans le sac Ã  dos", right: "2 heures de ski + dÃ©jeuner au chalet" },
  { t: "Tu ferais du saut Ã  lâ€™Ã©lastique ?", left: "Tout de suite !", right: "MÃªme pas payÃ© !" }
],

    en: [
  { t: "When I watch a movie", left: "I fall asleep after 10 minutes", right: "I watch it till the end" },
  { t: "The bed", left: "Must always be made", right: "Why bother, Iâ€™ll mess it up again tonight!" },
  { t: "The toothpaste tube", left: "I squeeze it from the bottom till the very last gram", right: "I squeeze it wherever my hand lands" },
  { t: "How much water do you drink?", left: "Sometimes my first glass is in the afternoon", right: "2L a day, no excuses" },
  { t: "Do you cook?", left: "Always, and I love it", right: "Someone else does it for me" },
  { t: "When I write an email", left: "I write it in one go", right: "I reread it 10 times before sending" },
  { t: "Packing before a trip", left: "I do it 30 minutes before leaving", right: "I start a week in advance" },
  { t: "When I go out for dinner with friends", left: "Iâ€™m the first to finish", right: "Everyoneâ€™s waiting for me to finish" },
  { t: "My perfect vacation day is", left: "Hiking in the mountains", right: "A beach day reading under the sun" },
  { t: "When I go shopping", left: "I check the price first", right: "I discover the price at the checkout" },
  { t: "When I go to bed", left: "I fall asleep in 2 seconds", right: "I count sheep for an hour" },
  { t: "A call with my parents", left: "Lasts 2 minutes on average (if I answer)", right: "Lasts an hour, I have to update them on everything" },
  { t: "My ideal ski day is", left: "Full day + sandwiches in the backpack", right: "2-hour skipass + lunch at the chalet" },
  { t: "Would you ever go bungee jumping?", left: "Absolutely!", right: "Not even if you paid me" }
],

  };

  // --------------- State ---------------
  let LANG = null;
  let QUESTIONS = [];
  let index = 0;
  let QUESTION_ORDER = [];
  let SIDE_MAP = [];
  const answers = [];
  let currentShareText = '';

  // Helpers
  const $ = sel => document.querySelector(sel);
  function tkey() { return STRINGS[LANG]; }

  function shuffle(arr){
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }
  function shuffleOrder(){
    QUESTION_ORDER = Array.from({length: QUESTIONS.length}, (_, i) => i);
    shuffle(QUESTION_ORDER);
    SIDE_MAP = QUESTION_ORDER.map(() => Math.random() < 0.5 ? 0 : 1);
  }
  function currentIndex(){ return QUESTION_ORDER[index]; }
  function currentQuestion(){ return QUESTIONS[currentIndex()]; }

  function updateProgress(){
    const pct = (index / QUESTIONS.length) * 100;
    $('#progressBar').style.width = pct + '%';
    $('#progressText').textContent = tkey().progress(index+1, QUESTIONS.length);
  }

  function renderQuestion(){
    const data = currentQuestion();
    const flip = SIDE_MAP[index] === 1;

    $('#qMeta').textContent = data.t || '';
    $('#questionText').textContent = '';

    const cont = $('#options');
    cont.innerHTML = '';

    const leftBtn = document.createElement('button');
    leftBtn.className = 'btn half left';
    leftBtn.type = 'button';

    const rightBtn = document.createElement('button');
    rightBtn.className = 'btn half right';
    rightBtn.type = 'button';

    leftBtn.textContent  = flip ? data.right : data.left;
    rightBtn.textContent = flip ? data.left  : data.right;

    if (answers[index] === 0) leftBtn.classList.add('selected');
    if (answers[index] === 1) rightBtn.classList.add('selected');

    leftBtn.addEventListener('click', () => { answers[index] = 0; goNext(); });
    rightBtn.addEventListener('click', () => { answers[index] = 1; goNext(); });

    cont.appendChild(leftBtn);
    cont.appendChild(rightBtn);

    $('#prevBtn').disabled = index === 0;
    updateProgress();
  }

  function goNext(){
    if (answers[index] == null) {
      const cont = $('#options');
      cont.classList.remove('need-pick');
      void cont.offsetWidth;
      cont.classList.add('need-pick');
      return;
    }
    if (index < QUESTIONS.length - 1){
      index++;
      renderQuestion();
    } else {
      finish();
    }
  }

  function goPrev(){
    if (index > 0){ index--; renderQuestion(); }
  }

  function finish(){
    let g = 0, c = 0;

    for (let i = 0; i < QUESTIONS.length; i++){
      const pickSide = answers[i];
      const flipped = SIDE_MAP[i] === 1;
      // Original mapping: left = Gianlu, right = Cha
      const pickedIsGianlu = flipped ? (pickSide === 1) : (pickSide === 0);
      if (pickedIsGianlu) g++; else c++;
    }

    const total = g + c;
    const gPct = Math.round((g/total)*100);
    const cPct = 100 - gPct;

    $('#gPct').textContent = gPct + '%';
    $('#cPct').textContent = cPct + '%';
    $('#gBar').style.width = gPct + '%';
    $('#cBar').style.width = cPct + '%';

    const summary = gPct > cPct ? tkey().moreG : gPct < cPct ? tkey().moreC : tkey().tie;
    $('#summaryText').textContent = summary;

    currentShareText = tkey().shareText(gPct, cPct, summary, window.location.href);

    $('#quiz').classList.add('hidden');
    $('#result').style.display = 'block';
    $('#progressBar').style.width = '100%';
    $('#progressText').textContent = tkey().allDone;
  }

  function applyUIStrings(){
    $('#subtitle').textContent = tkey().subtitle;
    $('#prevBtn').textContent = tkey().back;
    $('#nextBtn').textContent = tkey().next;
    $('#resultTitle').textContent = tkey().resultTitle;
    $('#shareBtn').textContent = tkey().share;
    $('#restartBtn').textContent = tkey().playAgain;
    $('#exitBtn').textContent = tkey().exit;
    document.documentElement.lang = LANG;
  }

  function startGameWithLanguage(lang){
    LANG = lang;
    QUESTIONS = QUESTIONS_BY_LANG[LANG].slice();
    index = 0;
    QUESTION_ORDER = [];
    SIDE_MAP = [];
    answers.length = QUESTIONS.length;
    for (let i=0;i<answers.length;i++) answers[i] = null;

    applyUIStrings();
    shuffleOrder();
    $('#result').style.display = 'none';
    $('#quiz').classList.remove('hidden');
    $('#shareFeedback').textContent = '';
    renderQuestion();
  }

  // -------------------- Events --------------------
  $('#nextBtn').addEventListener('click', goNext);
  $('#prevBtn').addEventListener('click', goPrev);
  $('#restartBtn').addEventListener('click', () => {
    index = 0;
    for (let i=0;i<answers.length;i++) answers[i] = null;
    shuffleOrder();
    $('#result').style.display = 'none';
    $('#quiz').classList.remove('hidden');
    $('#shareFeedback').textContent = '';
    renderQuestion();
  });

  $('#shareBtn').addEventListener('click', async () => {
    const feedback = $('#shareFeedback');
    try {
      if (navigator.share) {
        await navigator.share({ title: 'Team Cha vs Team Gianlu', text: currentShareText });
        feedback.textContent = tkey().shared;
      } else if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(currentShareText);
        feedback.textContent = tkey().copied;
      } else {
        const ta = document.createElement('textarea');
        ta.value = currentShareText; document.body.appendChild(ta); ta.select();
        document.execCommand('copy'); document.body.removeChild(ta);
        feedback.textContent = tkey().copied;
      }
    } catch {
      feedback.textContent = tkey().shareFail;
    }
    setTimeout(() => { feedback.textContent = ''; }, 3200);
  });

  document.getElementById('exitBtn').addEventListener('click', () => {
    window.location.href = 'https://www.charlottegianluca.it/home.html'; // <-- tua home
  });

  // Language overlay handlers
  document.querySelectorAll('.lang-btn').forEach(btn=>{
    btn.addEventListener('click', (e)=>{
      const lang = e.currentTarget.dataset.lang;
      $('#langOverlay').style.display = 'none';
      startGameWithLanguage(lang);
    });
  });

  // Start: show overlay, wait for selection
</script>
</body>
</html>
